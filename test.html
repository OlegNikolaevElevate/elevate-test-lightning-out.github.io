<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donation Form</title>
    <!-- This includes the Lightning Out library from the Salesforce org -->
    <script src="https://d2s--willdev.sandbox.my.site.com/portal/lightning/lightning.out.js"></script>
    <style>
        /* Optional styling for the container */
        .donation-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
    </style>
    <script src="https://www.google.com/recaptcha/api.js?render=6Lc4UWosAAAAAJ4lBbU7otrj0P4Dcp_3WDo-D_1w"></script>
</head>
<body>
    <!-- Container for the donation form -->
    <div class="donation-container">
        <div id="donationFormContainer"></div>
    </div>

    <script>
        grecaptcha.ready(function() {
                var reCAPTCHA_site_key = "6Lc4UWosAAAAAJ4lBbU7otrj0P4Dcp_3WDo-D_1w";
                grecaptcha.execute(reCAPTCHA_site_key, {action: 'submit'}).then(function(token) {
                    console.log('recaptcha github', token);
                    if (token == "") {
                        parent.postMessage({ action: "getCAPTCHA", callCAPTCHAResponse : "NOK"}, "*");
                    } else {
                        parent.postMessage({ action: "getCAPTCHA", callCAPTCHAResponse : token}, "*");
                    }
                });
            })
        // Initialize Lightning Out
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded4');
            // The experience cloud site (updated to production URL)
            const communityUrl = 'https://d2s--willdev.sandbox.my.site.com/portal';
            // const communityUrl = 'https://olegnikolaevelevate.github.io';
            
            $Lightning.use(
                "c:DonationApp", 
                function() {
                   console.log('Attempting to load component');
                    $Lightning.createComponent(
                        "c:finDockDonationForm", 
                        {
                            // Component attributes
                            formTitle: "Make a Donation",
                            suggestedAmounts: "25,50,100",
                            defaultDonationType: "oneTime",
                            allowRecurring: true,
                            allowWalletPayments: false,
                            showAddFeeCheckbox: false,
                            processingFeePercentage: 3,
                            successPageUrl: "https://d2s.my.site.com/portal/s/donation-thank-you",
                            failurePageUrl: "https://www.dare2share.org/donate",
                            campaignId: "701Ec00000mwkJnIAI",
                            configurationName: "Default",
                            currency: "USD",
                            isProd: true
                        },
                        "donationFormContainer", 
                        function(cmp) {
                            console.log("FinDock Donation Form loaded successfully");
                        }
                    );
                },
                communityUrl 
            );
        });
    </script>
</body>
</html>
